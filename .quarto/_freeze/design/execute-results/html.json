{
  "hash": "1d65833e331a1782d31c34dca5590e31",
  "result": {
    "markdown": "---\ntitle: \"Redesign\"\n---\n\n\n#### Redesign\n\nRedesigning the Original Graph\n\n#### Creating a Dotplot\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lattice)\nlibrary(tidyverse) \n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.4.4     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(plotly)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'plotly'\n\nThe following object is masked from 'package:ggplot2':\n\n    last_plot\n\nThe following object is masked from 'package:stats':\n\n    filter\n\nThe following object is masked from 'package:graphics':\n\n    layout\n```\n:::\n:::\n\n\nFrom the Original Graph Percentages of Men and Women are stored in the Men and Women Vector respectively and then these two vector values are stored in the Matrix form by using cbind.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMen <- c(10,23,50,5,12)\nWomen <- c(17,43,30,2,7) \nmat <- cbind(Men, Women)\nmat\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     Men Women\n[1,]  10    17\n[2,]  23    43\n[3,]  50    30\n[4,]   5     2\n[5,]  12     7\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nType <- c(\"Strong feminist\", \"Feminist\",\"Not a feminist\",\"Anti-feminist\", \"No opinion\") \nGender <- c(\"Men\",\"Women\")  \ncolnames(mat) <- Gender \nrownames(mat) <- Type \nmat\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                Men Women\nStrong feminist  10    17\nFeminist         23    43\nNot a feminist   50    30\nAnti-feminist     5     2\nNo opinion       12     7\n```\n:::\n:::\n\n\nThe below dotplot visualizes opinions about feminism based on gender, with points representing percentages in different categories.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFeminism = dotplot(mat, groups = FALSE, \n        layout = c(1, 2), aspect = .7, \n        origin = 0,type = c(\"p\",\"h\"),  \n        main = \"Opinion about feminism?\",  \n        xlab = \"Feminism based on Gender\",  \n        scales = list(x = list(tck = 0, alternating = FALSE)), \n        panel = function(...)\n          {     panel.fill(rgb(.9,.9,.9))   \n          panel.grid(h = 0,v = -1,col = \"white\",lwd = 2) \n          panel.dotplot(col = rgb(0,.5,1),cex = 1.1,...) \n          } ) \nFeminism\n```\n\n::: {.cell-output-display}\n![](design_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n#### Creating a Bar chart\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- data.frame(   Men = c(10, 23, 50, 5, 12),\n     Women = c(17, 43, 30, 2, 7), \n   row.names = c(\"Strong feminist\", \"Feminist\", \"Not a feminist\", \"Anti-feminist\", \"No opinion\") ) \nprint(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                Men Women\nStrong feminist  10    17\nFeminist         23    43\nNot a feminist   50    30\nAnti-feminist     5     2\nNo opinion       12     7\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      Men         Women     \n Min.   : 5   Min.   : 2.0  \n 1st Qu.:10   1st Qu.: 7.0  \n Median :12   Median :17.0  \n Mean   :20   Mean   :19.8  \n 3rd Qu.:23   3rd Qu.:30.0  \n Max.   :50   Max.   :43.0  \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsource(\"C:\\\\Users\\\\chpra\\\\OneDrive\\\\Documents\\\\MS\\\\STAT-515\\\\MidProject\\\\hw.R\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata$Opinion <- row.names(data) \nlibrary(tidyr) \nFeminismdata <- gather(data, Gender, Count, -Opinion) \nlibrary(ggplot2) \nggplot(Feminismdata, aes(x = Opinion, y = Count, fill = Gender)) +  \n  geom_bar(stat = \"identity\", position = \"dodge\") + \n  labs( x = \"Type\",  y = \"Count\", \n        title = \"Opinion about feminism based on Gender\") +hw \n```\n\n::: {.cell-output-display}\n![](design_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(Feminismdata, aes(x = Gender, y = Count, fill = Opinion)) + \n  geom_bar(stat = \"identity\", position = \"dodge\") + \n  labs(x=\"Gender\",y=\"Count\", \n       title=\"Gender based Feminism\", \n       fill=\"Types\") + hw\n```\n\n::: {.cell-output-display}\n![](design_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_ly(Feminismdata, x = ~Gender, y = ~Count, color =  ~Opinion, type = \"bar\")\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-81f9ecb8ddfb43d209cc\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-81f9ecb8ddfb43d209cc\">{\"x\":{\"visdat\":{\"4c1c36ae5440\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"4c1c36ae5440\",\"attrs\":{\"4c1c36ae5440\":{\"x\":{},\"y\":{},\"color\":{},\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"bar\"}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"Gender\",\"type\":\"category\",\"categoryorder\":\"array\",\"categoryarray\":[\"Men\",\"Women\"]},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"Count\"},\"hovermode\":\"closest\",\"showlegend\":true},\"source\":\"A\",\"config\":{\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"data\":[{\"x\":[\"Men\",\"Women\"],\"y\":[5,2],\"type\":\"bar\",\"name\":\"Anti-feminist\",\"marker\":{\"color\":\"rgba(102,194,165,1)\",\"line\":{\"color\":\"rgba(102,194,165,1)\"}},\"textfont\":{\"color\":\"rgba(102,194,165,1)\"},\"error_y\":{\"color\":\"rgba(102,194,165,1)\"},\"error_x\":{\"color\":\"rgba(102,194,165,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"Men\",\"Women\"],\"y\":[23,43],\"type\":\"bar\",\"name\":\"Feminist\",\"marker\":{\"color\":\"rgba(252,141,98,1)\",\"line\":{\"color\":\"rgba(252,141,98,1)\"}},\"textfont\":{\"color\":\"rgba(252,141,98,1)\"},\"error_y\":{\"color\":\"rgba(252,141,98,1)\"},\"error_x\":{\"color\":\"rgba(252,141,98,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"Men\",\"Women\"],\"y\":[12,7],\"type\":\"bar\",\"name\":\"No opinion\",\"marker\":{\"color\":\"rgba(141,160,203,1)\",\"line\":{\"color\":\"rgba(141,160,203,1)\"}},\"textfont\":{\"color\":\"rgba(141,160,203,1)\"},\"error_y\":{\"color\":\"rgba(141,160,203,1)\"},\"error_x\":{\"color\":\"rgba(141,160,203,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"Men\",\"Women\"],\"y\":[50,30],\"type\":\"bar\",\"name\":\"Not a feminist\",\"marker\":{\"color\":\"rgba(231,138,195,1)\",\"line\":{\"color\":\"rgba(231,138,195,1)\"}},\"textfont\":{\"color\":\"rgba(231,138,195,1)\"},\"error_y\":{\"color\":\"rgba(231,138,195,1)\"},\"error_x\":{\"color\":\"rgba(231,138,195,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"Men\",\"Women\"],\"y\":[10,17],\"type\":\"bar\",\"name\":\"Strong feminist\",\"marker\":{\"color\":\"rgba(166,216,84,1)\",\"line\":{\"color\":\"rgba(166,216,84,1)\"}},\"textfont\":{\"color\":\"rgba(166,216,84,1)\"},\"error_y\":{\"color\":\"rgba(166,216,84,1)\"},\"error_x\":{\"color\":\"rgba(166,216,84,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncategories <- c(\"Strong feminist\", \"Feminist\", \"Not a feminist\", \"Anti-feminist\", \"No opinion\") \nmen_percentages <- c(10, 23, 50, 5, 12) \nwomen_percentages <- c(17, 43, 30, 2, 7) \ndf <- data.frame(Category = categories, Men = men_percentages, Women = women_percentages)  \n\nggplot(df, aes(x = Category)) + \n  geom_bar(aes(y = Men, fill = \"Men\"), \n           stat = \"identity\", position = \"dodge\") +\n  geom_bar(aes(y = Women, fill = \"Women\"), \n           stat = \"identity\", position = \"dodge\") + \n  labs(x = \"Feminist Beliefs\", y = \"Percentage\",\n       title = \"Self-Identified Feminist Beliefs by Gender\") +\n  scale_fill_manual(values = c(\"Men\" = \"blue\", \"Women\" = \"yellow\")) +   theme_minimal() +  \n  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +  \n  guides(fill = guide_legend(title = 'Gender'))\n```\n\n::: {.cell-output-display}\n![](design_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "design_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\r\n<script src=\"site_libs/plotly-binding-4.10.4/plotly.js\"></script>\r\n<script src=\"site_libs/typedarray-0.1/typedarray.min.js\"></script>\r\n<script src=\"site_libs/jquery-3.5.1/jquery.min.js\"></script>\r\n<link href=\"site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\r\n<link href=\"site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}